
<!DOCTYPE HTML>
<html>
<head>
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>efficiency, economy and elegance  | work and hypertext</title>

<meta name="author" content="Gerardo Veltri"> 

<meta name="description" content="Detailing the goings-on of digital Gerardo."> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="work and hypertext" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
</head>



<body>
	<header id="header" class="inner"><h1><a href="/">work and hypertext</a></h1>
<h4>efficiency, economy and elegance</h4>
<nav id="main-nav"><ul>
	<li><a href="http://www.workandtext.com">work and text</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="http://www.workandtext.com">work and text</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:gveltri.github.io">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/10/01/mf-beta/">
		
			Deploying to Heroku</a>
	</h2>
	<div class="entry-content">
		<h3>Humble Beginnings</h3>

<p>This has probably been one of the most frustrating problems I have had with the app thus far, and of course, it has to do with the sometimes-obnoxious, sometimes-amazing magic dance of ruby on rails. When Nick and I began this project, neither of us knew anything about rails. I fired up a rails app naively, expecting to just be able to write like a JS wizard. So, I downloaded all my files like a noob and put them in lib. I open up my index, and I see the rails default index.html.</p>

<p>Scratching my head in frustration for a day, I finally pushed the index page into the public folder, replacing the default index.html with my own. Finally, I could see my own content. But now that I was trying to put the THREE et al.  library in the assets pipeline. Upon loading my index, nothing showed. Incredibly frustrating. I scoured stackoverflow and the rails documentation for a way to feed my assets to my index. Little did I know, the public index is not loaded with the same assets as the html files in views. I clearly did not understand MVC architecture and the way rails organizes its contents.</p>

<p><img class="left" src="/images/firstdir.png" width="100"></p>

<p>My temporary fix was cute. I moved the whole assets pipeline to the public directory of my app. The resulting directory tree looked like the directory on the left. Oh boy. It&rsquo;s tough looking at that now. But it worked for the development phase.</p>

<h3>Reorganizing</h3>

<p>Now that I&rsquo;ve worked on several apps, I&rsquo;ve gotten my ish together. Although the function of the app is incredibly simple, making it work with rails requires specific knowledge about the asset pipeline. Knowing where to put files and how to call them in a view is not as simple as one might think.</p>

<p><img class="right" src="/images/seconddir.png" width="100"></p>

<p>Firstly, a home controller has to handle the root to index. That&rsquo;s some basic stuff I didn&rsquo;t know before learning rails at Flatiron. Then, the assets have to be moved over from the public/app/assets directory to the proper app/assets/ path. It gets very messy here. The asset pipeline is like that boss that&rsquo;s easy to everyone else who plays the same video-game, and yet, I could never seem to beat him as a kid. I&rsquo;m having PTSD flashbacks to playing Zelda as a kid. BUt this time, I&rsquo;m not as ignorant. I know to add my requires in the application.js and application.css files; however, I spend a while figuring out that requiring the tree puts them in alphabetic order. That&rsquo;s bad when their dependencies are not alphabetical!</p>

<p>Anyways, I sort my js and css files out. I have an applicaiton that is semi-functional. None of my ply objects or textures have loaded. In order to do that, I need to 1) factor my gallery.js out to a partial, 2) put an asset_path tag anywhere I&rsquo;m loading a texture or ply object (omg my time is valuable tho), 3) configure the asset pipeline in my application.rb file.</p>

<p>Gotta' specify where things are for muh apps.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">paths</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/app/assets/textures&quot;</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">paths</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/app/assets/ply&quot;</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">paths</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/app/assets/shaders&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Web workers are a different thing. That&rsquo;s more complicated. Email me if you want my solution for how I got my ammo.js and physjs_worker.js to precompile and get called in my gallery partial.</p>

<h3>Deploying to Heroku</h3>

<p>Can we not even? Just kidding. It wasn&rsquo;t that bad. Sqlite is evil though. Don&rsquo;t do it. Heroku and its finecky nature!</p>

<p>But seriously, a tip I have for anyone deploying a web app to heroku that has to precompile web workers:</p>

<p>Precompile on your own machine with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="ss">assets</span><span class="p">:</span><span class="n">precompile</span>
</span></code></pre></td></tr></table></div></figure>


<p>and then deploy.</p>

<p>Spend your free time playing with olives at martha-friedman.herokuapp.com.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-10-01T10:43:08-04:00" pubdate data-updated="true"></time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/09/16/boolean-algebra/">
		
			A Bit of Boolean Logic and Its History</a>
	</h2>
	<div class="entry-content">
		<p>Understanding the fundamentals of computing is not only valuable for coding interviews. I would identify myself as someone who believes in this axiom: history helps us better understand the present. I’m particularly interested in how the machine processes information at the most fundamental level. Society is generally aware that our machines process information as a series of 0s and 1s, but how exactly does that work?</p>

<p><img class="right" src="/images/shannon.jpg"></p>

<p>The story of the 0s and 1s begins, for our intents and purposes, at MIT’s graduate school. Claude Shannon, who is famous for his later founding of information theory, wrote a masters thesis applying the slightly obscure Boolean algebra to the problem of telephone relays. For much of the 20th century, routing telephone calls was an incredibly costly operation. His thesis, <em>A Symbolic Analysis of Relay Switching Circuits</em>, showed that boolean algebra could simplify the system of relays that were currently in place as well as the converse&ndash;that relays could be arranged to solve problems in boolean algebra. This assertion made clear the relationship between circuits and logic gates.</p>

<p>We all know that a boolean is either 1 or 0, so boolean algebra is the set of operations that can be performed on a boolean. In every computer, circuits are a physical manifestation of the logic of booleans. This is the most basic logic that allows a program to run, for the computer to be booted&ndash;for anything to work digitally. These are its first order operations:</p>

<p><img class="left" src="/images/transistor.jpg"></p>

<h3>AND, OR, and NOT</h3>

<p><em>AND</em> is a conjunction. If and only if both booleans are true, then their conjunction is also true. We represent this in our higher-level programming languages (like Ruby and JavaScript) as <em>A &amp;&amp; B</em>.</p>

<p><em>OR</em> is a disjunction. If either boolean is true, then their disjunction is true. If both are false, then their disjunction is false. <em>A || B</em> in our terms.</p>

<p><em>NOT</em> is a negation. If a boolean is true, it&rsquo;s negation is false and vice versa. And as you might expect, <em>!A</em>.</p>

<p>Now, what interests me most about boolean logic is that the combination of these three basic functions produces all of the operations we could possibly want to do on any bit of information.</p>

<p>For example, a <em>NOR</em> is a combination of negation and disjunction. It is true if neither boolean is true. It would look something like <em>!(A || B)</em>.</p>

<p>By now, we can deduce what <em>NAND</em> might look like: <em>!(A &amp;&amp; B)</em>.</p>

<p>There are many ways of representing these operations, and perhaps one of the most clear ways is a truth table. Because operations can be strung together to make even more complicated operations, these tables can end up having many columns. Here&rsquo;s a rather simple truth table:</p>

<p><img src="/images/logic-table.png"></p>

<p><img class="right" src="/images/2to1mux.png" width="150"></p>

<p>And here&rsquo;s a truth table for a multiplexer. A multiplexer selects a signal based on the value of the selector, s. Muxes are everywhere. They are in your CPU, graphics card. The output of a Mux is Demuxed on the other end. Multiplexers allow an engineer to send multiple different signals over the same channel by selecting them at different times. Otherwise, a bunch of channels would be necessary. What&rsquo;s the obvious application for this? A telephone network&ndash;the original problem that Shannon exposed to boolean algebra.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-09-16T10:09:10-04:00" pubdate data-updated="true"></time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/09/02/sculpture-mechanics/">
		
			Modular Code for Modular Works of Art</a>
	</h2>
	<div class="entry-content">
		<p>&nbsp;&nbsp;&nbsp; A key feature of Martha Friedman&rsquo;s work is its modularity. Although you won&rsquo;t see people rearranging parts of pieces in the gallery, the human-scale sculptures appear composed of individual objects that are strung through poles or resting on boxes. The digital gallery, however, allows the user to enter an interactive fantasy in which the heavy and delicate pieces can be removed and reaffixed to other supports.</p>

<p><img class="right" src="/images/olive-totem.jpg" width="300" height="500"></p>

<p>&nbsp;&nbsp;&nbsp; Allowing the user to separate objects and rearrange them in a sensible way is an integral part of creating an impactful user experience. Otherwise, a perfectly rendered scene would harly differentiate itself from a photograph, which, along with text, is the artist&rsquo;s medium of choice for representing their artwork. Thus, a logical implementation of cohesion would elevate the gallery in its uniqueness and specificity to the artist&rsquo;s work.</p>

<p>&nbsp;&nbsp;&nbsp; The logic of this mechanic should follow the physical architecture of the sculpture. However it&rsquo;s made in real life should be reflected in the digital environment. <em>Olive Totem</em> (2011) has a cement cube base with a pole perpendicular to the ground. Rubber pimento-stuffed olives are placed at the top of the pole and slid down into place. In the world of computers, we call this a <em>stack</em>. A stack is a collection in which the last added element is the first one removed. Adding to a stack is calling pushing; removing, popping. If one wants to remove a digital olive from the digital armature, it has to be popped from an array of olives where the last olive is the highest on the totem.</p>

<p><img class="left" src="/images/stack.svg" width="300" height="500"></p>

<p>&nbsp;&nbsp;&nbsp; Stacks allow us to conceptualize how the problem might begin to be solved; however, none of the libraries used in this project provide an immediately useable solution to solving this problem. And after hacking away at this problem with my collaborator for a week or so, we discovered that our phsyics engine doesn&rsquo;t support porous meshes. That is&ndash; an olive can&rsquo;t simply have a hole in it and be strung onto the sculpture as in real life. The mechanics of olive stacking must be incorporated in the physics of the environment.</p>

<p>&nbsp;&nbsp;&nbsp; Because we&rsquo;ve already identified this arrangement of pieces as a stack, we know that the mechanics of sculpting will revolve around popping and pushing from an array. There are two majorly important pieces of data in this situation: the array of olives and the armature onto which the olives are &ldquo;snapped&rdquo;. Anyone who knows adobe products well should be familiar with snapping. Snapping is the sometimes-annoying function that moves an object to a specific position when it comes within a certain range of that position. Snapping is how the olives transition between being free objects and anchored to an armature. However, not just any object can be snapped on and off. Only the last object in the array is poppable. Upon initialization this object is pushed to the moveable_objects array, and when it is popped, the next olive is added to the moveable_objects array. The following code is the result of marrying this logic with the environment variables (mouse clicks), 3D models and physics engine.</p>

<p>&nbsp;&nbsp;&nbsp; At the top of my gallery.js, I declared the armature, intersect_cylinder, olives array, and slected_thing as global variables so that they can be accessed by the eventhandlers, the functions that handle user input.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">armature</span><span class="p">,</span> <span class="nx">intersect_cylinder</span><span class="p">,</span> <span class="nx">olives</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">selected_thing</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; When the mouse clicks an object (selected_thing), this bit of code is run. Here, it should unsnap an object if it the selected_thing is the last object in the olives array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">selected_thing</span> <span class="o">==</span> <span class="nx">olives</span><span class="p">[</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">olives</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">// only makes next olive moveable if it exists</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">olives</span><span class="p">[</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>When the mouse is unclicked, this bit of code is run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//retrieves coordinates of the mouse click</span>
</span><span class='line'><span class="nx">_vector</span><span class="p">.</span><span class="nx">set</span><span class="p">((</span><span class="nx">evt</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="o">-</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">clientY</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//a raycaster returns whatever intersects with the 3D line</span>
</span><span class='line'><span class="c1">//drawn from the camera through the mouse click on the near frustum</span>
</span><span class='line'><span class="nx">raycaster</span><span class="p">.</span><span class="nx">setFromCamera</span><span class="p">(</span><span class="nx">_vector</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">collisionResults</span> <span class="o">=</span> <span class="nx">raycaster</span><span class="p">.</span><span class="nx">intersectObjects</span><span class="p">(</span> <span class="p">[</span><span class="nx">intersect_cylinder</span><span class="p">,</span> <span class="nx">armature</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">olives</span><span class="p">)</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//if the mouse unclicks on any bit of the sculpture,</span>
</span><span class='line'><span class="c1">//the snapping function begins</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nx">collisionResults</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">snap_y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span> <span class="o">+</span> <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingSphere</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>      
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">snap_y</span> <span class="o">=</span> <span class="nx">olives</span><span class="p">[</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span>
</span><span class='line'>      <span class="o">+</span> <span class="nx">olives</span><span class="p">[</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingBox</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">x</span>
</span><span class='line'>      <span class="o">+</span> <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingBox</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">__dirtyPosition</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//put object in position</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="o">=</span><span class="nx">armature</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=</span><span class="nx">snap_y</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="o">=</span><span class="nx">armature</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//make object static</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">_v3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setAngularFactor</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setLinearFactor</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setLinearVelocity</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//make last object on olive totem moveable</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">last_index</span> <span class="o">=</span> <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">olives</span><span class="p">[</span><span class="nx">olives</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>    <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">last_index</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// avoids creating duplicates if the object is already in the moveable objects array</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//finally, push selected_thing on the olives stack</span>
</span><span class='line'>    <span class="nx">olives</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And with a lot of debugging, it works like a charm.</p>

<p>&nbsp;&nbsp;&nbsp; After playing around a bit in the console, adding new sculptures wherever I saw fit, I discovered a rather annoying problem. When I add another sculpture that has the armature/olive stack feature, I have to duplicate the code above. This code is not designed to scale with new sculptures being added, dynamically or not. Slightly restructuring the logic of this feature will improve the performance of the gallery and its potential for further development. It simply requires refactoring the olives and armature into an object that is then added to an array of globally accessible sculptures.</p>

<p>The resulting global variables are then simply:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">selected_thing</span><span class="p">,</span> <span class="nx">sculptures</span> <span class="o">=</span> <span class="p">[];</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the sculpture object looks something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Sculpture</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">armature</span><span class="p">,</span><span class="nx">modules</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">armature</span> <span class="o">=</span> <span class="nx">armature</span><span class="p">;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">modules</span> <span class="o">=</span> <span class="nx">modules</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">sculptures</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Which means that everything in the snapping function has to be changed accordingly.</p>

<p>Snapping off:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sculptures</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">selected_thing</span> <span class="o">==</span> <span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">[</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span><span class='line'>  <span class="c1">// only makes next olive moveable if it exists</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">[</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>  <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the snapping to:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">sculpture</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">collisionResults</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">_vector</span><span class="p">.</span><span class="nx">set</span><span class="p">((</span><span class="nx">evt</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="o">-</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">clientY</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">raycaster</span><span class="p">.</span><span class="nx">setFromCamera</span><span class="p">(</span><span class="nx">_vector</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//iterates through sculpture objects</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sculptures</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">collisionResults</span> <span class="o">=</span> <span class="nx">raycaster</span><span class="p">.</span><span class="nx">intersectObjects</span><span class="p">(</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">modules</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">armature</span><span class="p">));</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">collisionResults</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">sculpture</span> <span class="o">=</span> <span class="nx">sculptures</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class='line'>  <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nx">collisionResults</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">snap_y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11</span> <span class="o">+</span> <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingSphere</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">snap_y</span> <span class="o">=</span> <span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span>
</span><span class='line'>      <span class="o">+</span> <span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingBox</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">x</span>
</span><span class='line'>      <span class="o">+</span> <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">boundingBox</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">__dirtyPosition</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//put object in position</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="o">=</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">armature</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=</span><span class="nx">snap_y</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="o">=</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">armature</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//make object static</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">_v3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setAngularFactor</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setLinearFactor</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">selected_thing</span><span class="p">.</span><span class="nx">setLinearVelocity</span><span class="p">(</span><span class="nx">_v3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//make last object on sculpture stack moveable</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">last_index</span> <span class="o">=</span> <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">[</span><span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>    <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">last_index</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// avoids creating duplicates if the object is already in the moveable objects array</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//finally, push selected_thing on the sculpture stack</span>
</span><span class='line'>    <span class="nx">sculpture</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">selected_thing</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c1">//end snapping</span>
</span><span class='line'>
</span><span class='line'><span class="nx">selected_thing</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; Because I&rsquo;ve now folded the armature and olives into an object, I can further refactor the code to include logic specific to the piece. Moving forward, I plan to include new mechanics beyond stacking and animating the snapping and desnapping so as to enhance the user&rsquo;s experience.</p>

<p>&nbsp;&nbsp;&nbsp; Also, those damn olives need to be properly modeled.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-09-02T15:22:49-04:00" pubdate data-updated="true"></time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/08/19/illusion/">
		
			Perspective</a>
	</h2>
	<div class="entry-content">
		<p>&nbsp;&nbsp;&nbsp; There&rsquo;s a lot of mystification around the painted image. Many have admitted they couldn&rsquo;t make great works of art because they weren&rsquo;t born with the natural skill to render the natural world. Everytime we attribute great work in the arts to this mysterious genius-quotient, we are overlooking how art is created by means of technology, owing itself to more than simply the hands of a cinquecento master.</p>

<p>&nbsp;&nbsp;&nbsp; Paul Graham is particularly guilty of this in his essay &ldquo;Hackers and Painters&rdquo;. While attempting to praise the work of Leonardo DaVinci, he condescendingly puts emphasis on the painstaking work of painting every leaf in a bush. In fact, if we are to go along with Graham&rsquo;s comparison, almost anything could be substituted for painting. A hero figure works hard and paves the way for more people to do what he does. This argument is not specific and you shouldn&rsquo;t care about it. By allowing his audience to be mystified at DaVinci&rsquo;s genius, Graham avoids discussing what exactly makes oil painting significant.</p>

<p>&nbsp;&nbsp;&nbsp; There is a non-trivial relationship between Western oil painting and computing, and its love-child is 3D graphics. Let&rsquo;s talk a bit about painting. In the 15th century, Filippo Brunelleschi sketched the Florentine skyline on a mirror. By extending the lines of the buildings, he discovered that they were in fact perspectival orthogonals that converged on a vanishing point. This discovery began the widespread use of perspective on the Italian penninsula and, eventually, the rest of Europe. Others had guessed at perspective, and some were disinterested. However, Brunelleschi&rsquo;s discovery was significant because it revealed the geometric relationship of things in space to our perception of them. Whether beautiful or devotional, this method served to create an image that mimicked perception rather than coding objects' relationships symbolically.</p>

<p>&nbsp;&nbsp;&nbsp; Brunelleschi was not gifted with the ability to perfectly draw a skyline. Optical devices allowed him to separate the world that he perceived from its planar representation. Rather than having to paint everything outside his window, he could isolate that image to a flat surface. This is technology used interestingly. This is a hack. In 2002, artist David Hockney and physicist Charles M. Falco published a treatise on their theory that the photographic realism achieved by renaissance art is the result of optical technology: camera obscuras, camera lucidas, curved mirrors. Furthermore, artists like Giotto were calculating the orthogonals using rudimentary algebra.</p>

<p><img class="left" src="https://virtualterritory.files.wordpress.com/2007/05/a-duerer-a-man-drawing-a-lute-sml-512.jpg" width="300" height="500"></p>

<p>&nbsp;&nbsp;&nbsp; Painters used technology to discover the transformation of a three-dimensional space into a two-dimensional image as perceived from a position defined in that space. Computer graphics use a very similar understanding of perspective to project a scene. A projection is a flattening of  three-dimensional coordinates such that they can be presented on a two-dimensional surface. When we play video-games or work in CAD, we are experiencing the graphics engine rendering the scene by transforming a matrix of 3D coordinates into 2D coordinates. Oil painting happens at 50 frames per second.</p>

<p>&nbsp;&nbsp;&nbsp; In order for us to program this into the computer, we have to define this operation mathematically such that it is iterable. This is done through matrix multiplication. The graphic below demonstrates how the transformation matrix can be divided up into different operations on coordinates that follow the same rules.</p>

<p><img class="right" src="/images/matrix_transformation.png" width="300" height="500"></p>

<p>&nbsp;&nbsp;&nbsp; I&rsquo;ve begun to think a lot more about perspective since working with WebGL through Three.js. I had the issue of trying to create a ray that would intersect with objects on a field, allowing me to select those objects and move them with my cursor. This is a somewhat complex operation that is heavily simplified in the Three.js library.</p>

<p>&nbsp;&nbsp;&nbsp; When we click a screen, our computer doesn&rsquo;t intuit where in three-dimensional space where that click lands. The click corresponds to x- and y-coordinates. These clicks have to be extended into space using a ray-caster.</p>

<p>gallery.js</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">raycaster</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Raycaster</span><span class="p">(</span><span class="nx">camera</span><span class="p">,</span> <span class="mi">3</span><span class="nx">d_vector</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Three.js</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">THREE</span><span class="p">.</span><span class="nx">Raycaster</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">origin</span><span class="p">,</span> <span class="nx">direction</span><span class="p">,</span> <span class="nx">near</span><span class="p">,</span> <span class="nx">far</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">ray</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Ray</span><span class="p">(</span> <span class="nx">origin</span><span class="p">,</span> <span class="nx">direction</span> <span class="p">);</span>
</span><span class='line'>        <span class="c1">// direction is assumed to be normalized (for accurate distance</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">near</span> <span class="o">=</span> <span class="nx">near</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">far</span> <span class="o">=</span> <span class="nx">far</span> <span class="o">||</span> <span class="kc">Infinity</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">Sprite</span><span class="o">:</span> <span class="p">{},</span>
</span><span class='line'>                <span class="nx">Mesh</span><span class="o">:</span> <span class="p">{},</span>
</span><span class='line'>                <span class="nx">PointCloud</span><span class="o">:</span> <span class="p">{</span> <span class="nx">threshold</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
</span><span class='line'>                <span class="nx">LOD</span><span class="o">:</span> <span class="p">{},</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; This raycaster object is set with the coordinates of the camera and a three-dimensional vector that is constructed from the mouse-click. The mouse-click&rsquo;s z-coordinate is set to 1, the near frustum, thus the mouse is told that it intersects with the frame of the screen as a plane in the 3D environment. When we ask the raycaster what it intersects with in the scene,it creates a line of spheres extending into the scene along this line and checks if those spheres intersect with the coordinates of any of the objects. This is an extremely basic explanation of hundreds of lines of code. Nonetheless, the logic of it can be understood. Three.js gets around the problem of unprojecting a vector by drawing a three-dimensional line between two points.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-08-19T09:51:43-04:00" pubdate data-updated="true"></time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/08/05/project-updates/">
		
			Project Updates</a>
	</h2>
	<div class="entry-content">
		<h3>BASH Shell Scripts</h3>

<p>&nbsp;&nbsp;&nbsp; Over the last few weeks, I&rsquo;ve been working on a few projects with varying motivations and goals. Before I started at Flatiron, I began using a text editor called emacs as per the advice of a friend who works on OpenBSD. The editor is daunting at first. The learning curve is enormous. After using it for an hour, I wondered why anyone would bother; however, having used it for three and a half weeks, my efficiency in writing code has gone up significantly.</p>

<p>&nbsp;&nbsp;&nbsp; While the program is extremely difficult to learn, memorizing the key-commands results in your hands never having to leave the home position. No more shifting your hands from the keyboard to the mouse to click an area of text. Further, the editor can be customized to reduce the number of times one klicks the keyboard. Becoming more efficient at using the computer is like a drug. Since starting at Flatiron, I&rsquo;ve been seeking ways to speed up the lab-completion process, so I can spend more time reviewing and refactoring code.</p>

<p>&nbsp;&nbsp;&nbsp; So, naturally, I started writing some basic shell scripts. When bash loads, it loads a file called ~/.bash_profile where one can write new shortcuts like &ldquo;subl&rdquo; to open sublime or &ldquo;ll&rdquo; to shorten &ldquo;ls -lah&rdquo;. When we start and end a lab, there&rsquo;s a series of bash commands we all use in succession. They are best condensed and shortened to one command. So, with a bit of research, I set out to write two short scripts.</p>

<p>&nbsp;&nbsp;&nbsp; The first one clones a repository and then changes to the directory that it created.</p>

<p>~/.bash_bin/gitclonecd.sh</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">string</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'>git clone <span class="nv">$string</span>
</span><span class='line'>
</span><span class='line'><span class="nv">string</span><span class="o">=</span><span class="k">${</span><span class="nv">string</span><span class="p">#*/</span><span class="k">}</span>
</span><span class='line'><span class="nv">string</span><span class="o">=</span><span class="k">${</span><span class="nv">string</span><span class="p">%.*</span><span class="k">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">cd</span> <span class="k">${</span><span class="nv">string</span><span class="k">}</span>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;cloned and moved into directory ${string)&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; However, if I wanted to use this script, I would have to type the file name and path in terminal. I needed to also write an alias in my .bash_profile file that would automatically call the script and feed it the command-line argument.</p>

<p>~/.bash_profile</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">alias </span><span class="nv">gitf</span><span class="o">=</span><span class="s2">&quot;. ~/.bash_bin/gitaddcommitpush.sh&quot;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gits</span><span class="o">=</span><span class="s2">&quot;. ~/.bash_bin/gitclonecd.sh&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; The second alias refers to the script pasted above. The first alias refers to the first script I made. This one handles adding, committing, pushing and changing to the above directory.</p>

<p>~/.bash_bin/gitaddcommitpush.sh</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">string</span><span class="o">=</span><span class="nv">$@</span>
</span><span class='line'>
</span><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s2">&quot;${string}&quot;</span>
</span><span class='line'>git push origin master
</span><span class='line'>hub browse
</span><span class='line'><span class="nb">cd</span> ..
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Pushed to Github with message ${string}.&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; There are some non-ideal elements to these scripts. <del>For one, the $string variable only takes one command-line argument. Arguments in bash are separated by white space. I can effectively only push a commit with one word. Luckily, that suffices for labs.</del> <em>I fixed this problem using $@ and interpolating the variable on line 3. $@ returns all command line arguments in one variable.</em> <del>Secondly, the command-line argument in the first shell script&ndash;the url for the remote repository&ndash;is reduced to a substring in a very inelegant way. Instead of being returned with regex, it is hardcoded with the index of the string. If anyone wants to use this script, they will have to change lines 3 and 4 to reflect their own account&rsquo;s url. As I learn more bash shell script language, I plan to improve this code.</del> <em>This was improved with the use of some &ldquo;shell built-ins&rdquo;. The code in gitclonecd.sh extracts everything left of &ldquo;.&rdquo; and everything right of &ldquo;/&rdquo; returning the name of the directory that had already been cloned.</em></p>

<h3>An Artist&rsquo;s Website</h3>

<p>&nbsp;&nbsp;&nbsp; Several months ago, a friend of mine who makes large, beautiful and oddly sexual sculptures was talking to me about artist websites. She regretted she didn&rsquo;t have one but acknowledged that her vision would cost a significant amount of money to build. Her idea was to have a website where one could pull about the modules of her pieces, which would allow the digital viewer to recombine the pieces in order to create new sculptures. At the time, I had only a bit of experience with building websites, having worked on my own with HTML, CSS and very basic JS.</p>

<p>&nbsp;&nbsp;&nbsp; A few months later, a friend of mine was working on an interactive web game with the javascript library, THREE.js. THREE allows someone with slightly-more-than-basic understanding of javascript to model and render three-dimensional objects in a web browser. While browsing the examples of THREE, a page using a second library, Physi.js, an interactive Jenga game caught my attention. The blocks were beautifully rendered. One could pull out a block, and the tower would collapse rather realistically.</p>

<p>&nbsp;&nbsp;&nbsp; It took me another few months to make the connection. I could build this sculptor&rsquo;s website using these two libraries, giving her exactly what she was looking for. In the end, I would get a fulfilling web graphics project with my name on an influential artist&rsquo;s website. So, I pitched her the idea with my friend, and she was elated.</p>

<p>&nbsp;&nbsp;&nbsp; Last week, I began writing the code that would sketch out the basic environment of the web gallery. Here&rsquo;s a snippet of code to illustrate how the libraries work.</p>

<p>marthafriedman/public/app/assets/javascripts/gallery.js</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">box</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Physijs</span><span class="p">.</span><span class="nx">BoxMesh</span><span class="p">(</span>
</span><span class='line'><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">(</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="p">),</span>
</span><span class='line'><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">MeshLambertMaterial</span><span class="p">({</span> <span class="nx">color</span><span class="o">:</span> <span class="mh">0xFF66FF</span> <span class="p">}),</span>
</span><span class='line'>    <span class="p">.</span><span class="mi">4</span><span class="p">,</span>
</span><span class='line'><span class="p">.</span><span class="mi">4</span>
</span><span class='line'>
</span><span class='line'><span class="p">);</span>
</span><span class='line'><span class="nx">box</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
</span><span class='line'><span class="nx">box</span><span class="p">.</span><span class="nx">castShadow</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="nx">box</span><span class="p">.</span><span class="nx">receiveShadow</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">box</span> <span class="p">);</span>
</span><span class='line'><span class="nx">moveable_objects</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">box</span> <span class="p">);</span> <span class="c1">//add box to the array of shit that can be moved</span>
</span></code></pre></td></tr></table></div></figure>


<p>&nbsp;&nbsp;&nbsp; Line one declares a new Physijs object with four different arguments. The first argument gives the object a shape; the second gives the object a mesh that reacts to light and has a color (in this case, pink), the third and fourth correspond to the object&rsquo;s friction and restitution. The last line adds the box to an array of things that can eventually be clicked. That bit of code is dealt with later in the gallery.js file and is currently giving me a headache. But, it&rsquo;s all part of the process.</p>

<p>Here&rsquo;s a progress pics, because&ndash;well&ndash;pics or it didn&rsquo;t happen.</p>

<p><img src="http://i.imgur.com/dO966CM.png"></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-08-05T21:05:54-04:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/artist-websites/'>artist websites</a>, <a class='category' href='/blog/categories/javascript/'>javascript</a>, <a class='category' href='/blog/categories/physijs/'>physijs</a>, <a class='category' href='/blog/categories/shell-scripts/'>shell scripts</a>, <a class='category' href='/blog/categories/threejs/'>threejs</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/07/29/pilot/">
		
			PILOT</a>
	</h2>
	<div class="entry-content">
		<p>It&rsquo;s here&ndash;the blog that few have sought and even fewer have found.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-29T14:51:08-04:00" pubdate data-updated="true"></time></div>
	


	
</div></article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Gerardo Veltri

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
